let data={axis:"all",isStyleAdded:!1,transform:{declared:!1,string:""},initialX:0,initialY:0,cursorInitialX:0,cursorInitialY:0},elements={grab:null,move:null},eventClass={initial:"drag-draggable",hasHandle:"drag-uses-handle",handle:"drag-handle",down:"drag-down",move:"drag-move"};function isObject(c,d,f){return c instanceof Object?d:f}function returnPositionString(c,d){return`matrix(${data.transform.string}, ${c}, ${d})`}function getPosition(c,d,f){let g=getMatrixSection(c),h=parseInt(window.getComputedStyle(d)[f].slice(0,-2));return"left"===f&&"none"!==c?h+=parseInt(c.slice(g[3]+2,g[4])):"top"==f&&"none"!==c&&(h+=parseInt(c.slice(g[4]+2,-1))),h}function getMousePosition(c){return{x:(c.pageX||c.touches[0].pageX)-data.cursorInitialX,y:(c.pageY||c.touches[0].pageY)-data.cursorInitialY}}function getMatrixSection(c){let f,d=[];for(f=0;f<c.length;f++)","===c[f]&&d.push(f);return d}function dragDown(c,d,f,g){let h=c.value;elements.grab=d,elements.move=f,data.cursorInitialX=g.pageX||g.touches[0].pageX,data.cursorInitialY=g.pageY||g.touches[0].pageY,data.relativeX=0,data.relativeY=0;let j=window.getComputedStyle(f).transform;"none"==j?(data.transform.declared=!1,data.transform.string="1, 0, 0, 1"):(data.transform.declared=!0,data.transform.string=j.slice(7,getMatrixSection(j)[3]));let k=isObject(h,h.axis,c.arg);"x"!=k&&"y"!=k&&(k="all"),data.axis=k,data.initialX=getPosition(j,f,"left"),data.initialY=getPosition(j,f,"top"),f.style.transform=returnPositionString(data.initialX,data.initialY),f.style.left=0,f.style.top=0,d.classList.add(eventClass.down),document.addEventListener("mousemove",updatePosition[k]),document.addEventListener("touchmove",updatePosition[k])}const updatePosition={addClass:function(){elements.move.classList.add(eventClass.move),updatePosition.addClass=function(){}},x:function(c){let d=getMousePosition(c);updatePosition.addClass(),data.relativeX=d.x,elements.move.style.transform=returnPositionString(data.initialX+d.x,data.initialY)},y:function(c){let d=getMousePosition(c);updatePosition.addClass(),data.relativeY=d.y,elements.move.style.transform=returnPositionString(data.initialX,data.initialY+d.y)},all:function(c){let d=getMousePosition(c);updatePosition.addClass(),data.relativeX=d.x,data.relativeY=d.y,elements.move.style.transform=returnPositionString(data.initialX+d.x,data.initialY+d.y)}};function dragUp(){elements.move&&(elements.move.style.transform=data.transform.declared?returnPositionString(0,0):"none",elements.move.style.left=data.initialX+data.relativeX+"px",elements.move.style.top=data.initialY+data.relativeY+"px",updatePosition.addClass=function(){elements.move.classList.add(eventClass.move),updatePosition.addClass=function(){}},elements.grab.classList.remove(eventClass.down),elements.move.classList.remove(eventClass.move),document.removeEventListener("mousemove",updatePosition[data.axis]),document.removeEventListener("touchmove",updatePosition[data.axis]))}function createDraggable(c,d){let g=d.value,j,k,l;if(!data.isStyleAdded){data.isStyleAdded=!0;let n=document.createElement("style");n.innerHTML=`.${eventClass.initial} { position: relative; } .${eventClass.initial}:not(.${eventClass.hasHandle}), .${eventClass.handle} { cursor: move; cursor: grab; cursor: -webkit-grab; cursor: -moz-grab; } .${eventClass.handle}.${eventClass.down}, .${eventClass.initial}:not(.${eventClass.hasHandle}).${eventClass.down} { z-index: 999; cursor: grabbing; cursor: -webkit-grabbing; cursor: -moz-grabbing; }`,document.body.appendChild(n)}j=isObject(g,g.handle,g);let m=document.getElementById(j);g&&!m&&g.handle?console.error(`Element with id “${g.handle||g}” doesn’t exist`):(m?(k=m,l=c,l.classList.add(eventClass.hasHandle),k.classList.add(eventClass.handle)):(k=c,l=c),l.classList.add(eventClass.initial),k.onmousedown=n=>dragDown(d,k,l,n),k.ontouchstart=n=>dragDown(d,k,l,n)),document.addEventListener("mouseup",dragUp),document.addEventListener("touchend",dragUp)}const vDrag={install(c,d){if(d){let f=d.eventClass;for(let g in eventClass)f[g]&&(eventClass[g]=f[g])}c.directive("drag",{inserted:function(f,g,h){createDraggable(f,g,h)},update:function(f,g,h){createDraggable(f,g,h)}})}};"undefined"!=typeof window&&window.Vue?window.Vue.use(vDrag):module.exports=vDrag;
