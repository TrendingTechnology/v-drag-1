/*!
 * v-drag v1.3.0
 * by Nil Vila
 */
const data={axis:"all",matrix:!1},elements={grab:null,move:null},coord={mouse:{x:0,y:0},matrix:{x:0,y:0},initial:{x:0,y:0},relative:{x:0,y:0}},eventClass={initial:"drag-draggable",hasHandle:"drag-uses-handle",handle:"drag-handle",down:"drag-down",move:"drag-move"};let posAnimation;function returnPositionString(e,t){return`matrix(${data.matrix?data.matrix:"1, 0, 0, 1,"} ${e}, ${t})`}function getTransformValue(e,t){let o=Number(window.getComputedStyle(elements.move)[t].replace("px",""));if("none"!==e){const n=e.match(/[0-9.-]+/g);o+=Number(n[8-t.length])}return o}function eventListener(e,t,o="add"){e.forEach(e=>{document[`${o}EventListener`](e,t)})}function moveElementTransform(e,t,o){elements.move.style.transform=e,elements.move.style.left=t,elements.move.style.top=o}function updateMousePosition(e){coord.mouse.x=(e.pageX||e.touches[0].pageX)-coord.initial.x,coord.mouse.y=(e.pageY||e.touches[0].pageY)-coord.initial.y}function updatePosition(e,t){coord.relative.x=coord.mouse.x*e,coord.relative.y=coord.mouse.y*t,elements.move.style.transform=returnPositionString(coord.matrix.x+coord.mouse.x*e,coord.matrix.y+coord.mouse.y*t)}const callPositionUpdate={x(){updatePosition(!0,!1)},y(){updatePosition(!1,!0)},all(){updatePosition(!0,!0)}};function repeatRaf(){callPositionUpdate[data.axis](),posAnimation=requestAnimationFrame(repeatRaf)}function setUpMovement(){elements.move.classList.add(eventClass.move),posAnimation=requestAnimationFrame(repeatRaf),eventListener(["mousemove","touchmove"],setUpMovement,"remove")}function dragStart(e,t,o,n){elements.grab=e,elements.move=t,data.axis=o,coord.initial.x=n.pageX||n.touches[0].pageX,coord.initial.y=n.pageY||n.touches[0].pageY,coord.relative.x=0,coord.relative.y=0;const a=window.getComputedStyle(t).transform;data.matrix="none"!==a&&a.match(/\d([^,]*,){4}/g);const s=getTransformValue(a,"left"),r=getTransformValue(a,"top");moveElementTransform(returnPositionString(s,r),0,0),coord.matrix.x=s,coord.matrix.y=r,e.classList.add(eventClass.down),eventListener(["mousemove","touchmove"],updateMousePosition),eventListener(["mousemove","touchmove"],setUpMovement)}function dragEnd(){cancelAnimationFrame(posAnimation),eventListener(["mousemove","touchmove"],setUpMovement,"remove"),moveElementTransform(data.matrix?returnPositionString(0,0):"none",`${coord.matrix.x+coord.relative.x}px`,`${coord.matrix.y+coord.relative.y}px`),elements.grab.classList.remove(eventClass.down),elements.move.classList.remove(eventClass.move),eventListener(["mousemove","touchmove"],updateMousePosition,"remove")}function dragSetup(e,t){const o=t.value;let n,a,s,r;o instanceof Object?[n,a]=[o.axis,o.handle]:[n,a]=[t.arg,o],"x"!==n&&"y"!==n&&(n="all");const i=document.getElementById(a);o&&!i&&o.handle?console.error(`Element with id “${o.handle||o}” doesn’t exist`):(i?(s=i,(r=e).classList.add(eventClass.hasHandle),s.classList.add(eventClass.handle)):(s=e,r=e),r.classList.add(eventClass.initial),s.onmousedown=(e=>dragStart(s,r,n,e)),s.ontouchstart=(e=>dragStart(s,r,n,e))),eventListener(["mouseup","touchend"],dragEnd)}export default{install(e,t){if(t){const e=t.eventClass;Object.keys(e).forEach(t=>{e[t]&&(eventClass[t]=e[t])})}const o=document.createElement("style");o.innerHTML=`.${eventClass.initial}{position:relative;}.${eventClass.initial}:not(.${eventClass.hasHandle}),.${eventClass.handle}{cursor:move;cursor:grab;cursor:-webkit-grab;cursor:-moz-grab;}.${eventClass.handle}.${eventClass.down},.${eventClass.initial}:not(.${eventClass.hasHandle}).${eventClass.down}{z-index:999;cursor:grabbing;cursor:-webkit-grabbing;cursor:-moz-grabbing;}`,document.body.appendChild(o),e.directive("drag",{inserted(e,t){dragSetup(e,t)},update(e,t){e.onmousedown=null,e.ontouchstart=null;const o=document.getElementById(t.oldValue)||document.getElementById(t.oldValue.handle);o&&(o.onmousedown=null,o.ontouchstart=null,o.classList.remove(eventClass.handle),e.classList.remove(eventClass.hasHandle)),dragSetup(e,t)}})}};
