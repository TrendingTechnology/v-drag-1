/*!
 * v-drag v1.2.4
 * by Nil Vila
 */
const data={axis:"all",transform:{declared:!1,string:""},initialX:0,initialY:0,cursorInitialX:0,cursorInitialY:0},elements={grab:null,move:null};let mousePosition={x:0,y:0};const eventClass={initial:"drag-draggable",hasHandle:"drag-uses-handle",handle:"drag-handle",down:"drag-down",move:"drag-move"};let posAnimation,isMoveStarted=!1;function eventListener(e,t,a="add",n=document){"add"===a?e.forEach(e=>{n.addEventListener(e,t)}):"remove"===a&&e.forEach(e=>{n.removeEventListener(e,t)})}function moveElementTransform(e,t,a){elements.move.style.transform=e,elements.move.style.left=t,elements.move.style.top=a}function returnPositionString(e,t){return`matrix(${data.transform.string} ${e}, ${t})`}function getTransformValue(e,t){let a=Number(window.getComputedStyle(elements.move)[t].replace("px",""));if("none"!==e){const n=e.match(/[0-9., -]+/)[0].split(", ");"left"===t?a+=Number(n[4]):"top"===t&&(a+=Number(n[5]))}return a}function updateMousePosition(e){mousePosition={x:(e.pageX||e.touches[0].pageX)-data.cursorInitialX,y:(e.pageY||e.touches[0].pageY)-data.cursorInitialY}}const updatePosition={addClass(){elements.move.classList.add(eventClass.move),updatePosition.addClass=function(){}},x(){data.relativeX=mousePosition.x,elements.move.style.transform=returnPositionString(data.initialX+mousePosition.x,data.initialY)},y(){data.relativeY=mousePosition.y,elements.move.style.transform=returnPositionString(data.initialX,data.initialY+mousePosition.y)},all(){data.relativeX=mousePosition.x,data.relativeY=mousePosition.y,elements.move.style.transform=returnPositionString(data.initialX+mousePosition.x,data.initialY+mousePosition.y)}};function posUpdate(){updatePosition[data.axis](),posAnimation=requestAnimationFrame(posUpdate)}function startMovement(){isMoveStarted?eventListener(["mousemove","touchmove"],startMovement,"remove"):(updatePosition.addClass(),isMoveStarted=!0,posAnimation=requestAnimationFrame(posUpdate))}function dragDown(e,t,a,n){const o=t,s=a;elements.grab=o,elements.move=s,data.axis=e,data.cursorInitialX=n.pageX||n.touches[0].pageX,data.cursorInitialY=n.pageY||n.touches[0].pageY,data.relativeX=0,data.relativeY=0;const i=window.getComputedStyle(a).transform;"none"===i?(data.transform.declared=!1,data.transform.string="1, 0, 0, 1,"):(data.transform.declared=!0,[data.transform.string]=i.match(/\d([^,]*,){4}/g)),data.initialX=getTransformValue(i,"left"),data.initialY=getTransformValue(i,"top"),moveElementTransform(returnPositionString(data.initialX,data.initialY),0,0),o.classList.add(eventClass.down),eventListener(["mousemove","touchmove"],updateMousePosition),eventListener(["mousemove","touchmove"],startMovement)}function dragUp(){cancelAnimationFrame(posAnimation),isMoveStarted=!1,eventListener(["mousemove","touchmove"],startMovement,"remove"),moveElementTransform(data.transform.declared?returnPositionString(0,0):"none",`${data.initialX+data.relativeX}px`,`${data.initialY+data.relativeY}px`),updatePosition.addClass=function(){elements.move.classList.add(eventClass.move),updatePosition.addClass=function(){}},elements.grab.classList.remove(eventClass.down),elements.move.classList.remove(eventClass.move),eventListener(["mousemove","touchmove"],updateMousePosition,"remove")}function createDrag(e,t){const a=t.value;let n,o,s,i;a instanceof Object?[n,o]=[a.axis,a.handle]:[n,o]=[t.arg,a],"x"!==n&&"y"!==n&&(n="all");const r=document.getElementById(o);a&&!r&&a.handle?console.error(`Element with id “${a.handle||a}” doesn’t exist`):(r?(s=r,(i=e).classList.add(eventClass.hasHandle),s.classList.add(eventClass.handle)):(s=e,i=e),i.classList.add(eventClass.initial),s.onmousedown=(e=>dragDown(n,s,i,e)),s.ontouchstart=(e=>dragDown(n,s,i,e))),eventListener(["mouseup","touchend"],dragUp)}export default{install(e,t){if(t){const e=t.eventClass;Object.keys(e).forEach(t=>{e[t]&&(eventClass[t]=e[t])})}const a=document.createElement("style");a.innerHTML=`.${eventClass.initial}{position:relative;}.${eventClass.initial}:not(.${eventClass.hasHandle}),.${eventClass.handle}{cursor:move;cursor:grab;cursor:-webkit-grab;cursor:-moz-grab;}.${eventClass.handle}.${eventClass.down},.${eventClass.initial}:not(.${eventClass.hasHandle}).${eventClass.down}{z-index:999;cursor:grabbing;cursor:-webkit-grabbing;cursor:-moz-grabbing;}`,document.body.appendChild(a),e.directive("drag",{inserted(e,t){createDrag(e,t)},update(e,t){if(t.oldValue){const e=document.getElementById(t.oldValue)||document.getElementById(t.oldValue.handle);e&&(e.onmousedown=null,e.ontouchstart=null,e.classList.remove(eventClass.handle))}createDrag(e,t)}})}};